/* * * * * * * * * * * *
 *  micromarkdown .js  *
 *    Version 0.1.2    *
 *    License:  MIT    *
 *   Simon  Waldherr   *
 * * * * * * * * * * * */

var micromarkdown={useajax:!1,regexobject:{hr:/(?:[\*\-_]+) ?\1/gm,lists:/^(( *\* [^\n]+)\n)+/gm,headline:/^(\#{1,6})([^\#\n]+)\n/m,code:/\n\`\`\`\n?([^`]+)\`\`\`/g,bolditalic:/(?:([\*_~]{1,3}))([^\*_~\n]+)\1/g,links:/!?\[([^\]<>]+)\]\(([^ \)<>]+)( "[^\(\)\"]+")?\)/g,tables:/\n(([^|\n]+ *\| *)+([^|\n]+\n))(\-+\|)+(\-+\n)((([^|\n]+ *\| *)+([^|\n]+)\n)+)/g,include:/[\[<]include (\S+) from (https?:\/\/[a-z0-9\.\-]+\.[a-z]{2,9}[a-z0-9\.\-\?\&\/]+)[\]>]/gi},parse:function(a){"use strict";var b,c,d,e,f,g,h,i,j,k=0,l=0;for(a="\n"+a+"\n";null!==(j=micromarkdown.regexobject.code.exec(a));)a=a.replace(j[0],"<code>\n"+micromarkdown.htmlencode(j[1]).replace(/\n/gm,"<br/>").replace(/\ /gm,"&nbsp;")+"</code>\n");for(;null!==(j=micromarkdown.regexobject.headline.exec(a));)h=j[1].length,a=a.replace(j[0],"<h"+h+">"+j[2]+"</h"+h+">\n");for(;null!==(j=micromarkdown.regexobject.hr.exec(a));)console.log(j),a=a.replace(j[0],"<hr/>\n");for(;null!==(j=micromarkdown.regexobject.lists.exec(a));){for(i="<ul>",e=j[0].split("\n"),d=0,k=0;k<e.length;k++)null!==(b=/^(( )*\* ([^\n]+))/.exec(e[k]))&&(c=void 0===b[2]?0:b[2].length,d>c&&(i+="<ul>",d=c),i+="<li>"+b[3]+"</li>\n",c>d&&(i+="</ul>",d=c));i+="</ul>",a=a.replace(j[0],i+"\n")}for(;null!==(j=micromarkdown.regexobject.bolditalic.exec(a));)if(i=[],"~~"===j[1])a=a.replace(j[0],"<del>"+j[2]+"</del>");else{switch(j[1].length){case 1:i=["<i>","</i>\n"];break;case 2:i=["<b>","</b>\n"];break;case 3:i=["<i><b>","</b></i>\n"]}a=a.replace(j[0],i[0]+j[2]+i[1])}for(;null!==(j=micromarkdown.regexobject.tables.exec(a));){for(i="<table><tr>",e=j[1].split("|"),k=0;k<e.length;k++)i+="<th>"+e[k]+"</th>";for(i+="</tr>",f=j[6].split("\n"),k=0;k<f.length;k++)if(g=f[k].split("|"),0!==g[0].length){for(i+="<tr>",l=0;l<g.length;l++)i+="<td>"+g[l]+"</td>";i+="</tr>\n"}i+="</table>",a=a.replace(j[0],i)}for(;null!==(j=micromarkdown.regexobject.links.exec(a));)a="!"===j[0].substr(0,1)?a.replace(j[0],'<img src="'+j[2]+'" alt="'+j[1]+'" title="'+j[1]+'" />\n'):a.replace(j[0],'<a href="'+j[2]+'">'+j[1]+"</a>\n");if(micromarkdown.useajax!==!1)for(;null!==(j=micromarkdown.regexobject.include.exec(a));)if(e=j[2].replace(/[\.\:\/]+/gm,""),f="",document.getElementById(e)?f=document.getElementById(e).innerHTML.trim():micromarkdown.ajax(j[2]),"csv"===j[1]&&""!==f){for(g={},g[";"]=[],g[","]=[],f=f.split("\n"),k=0;k<f.length;k++)g[";"][k]=f[k].split(";").length,k>0&&g[";"]!==!1&&(g[";"][k]!==g[";"][k-1]||1===g[";"][k])&&(g[";"]=!1),g[","][k]=f[k].split(",").length,k>0&&g[","]!==!1&&(g[","][k]!==g[","][k-1]||1===g[","][k])&&(g[","]=!1);if(g[","]!==!1||g[";"]!==!1){for(g=g[";"]!==!1?";":",",i="<table>",k=0;k<f.length;k++){for(e=f[k].split(g),i+="<tr>",l=0;l<e.length;l++)i+="<td>"+e[l]+"</td>";i+="</tr>"}i+="</table>",a=a.replace(j[0],i)}else a=a.replace(j[0],"<code>"+f.join("\n")+"</code>")}else a=a.replace(j[0],"");return a=a.replace(/ {2,}[\n]{1,}/gim,"</br></br>")},ajax:function(a){"use strict";var b;if(document.getElementById(a.replace(/[\.\:\/]+/gm,"")))return!1;if(window.ActiveXObject)try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){return b=null,c}else b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===b.readyState){var c=document.createElement("code");c.innerHTML=b.responseText,c.id=a.replace(/[\.\:\/]+/gm,""),c.style.display="none",document.getElementsByTagName("body")[0].appendChild(c),micromarkdown.useajax()}},b.open("GET",a,!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.send()},htmlencode:function(a){"use strict";return a.replace(/[\u00A0-\u2666<>\&]/g,function(a){return"&"+(micromarkdown.entityTable[a.charCodeAt(0)]||"#"+a.charCodeAt(0))+";"})},entityTable:{34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"}};

/* /micromarkdown */
